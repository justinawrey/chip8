// 4kB, or 4056 bytes
const RAM_SIZE = 4056
const ROM_START = 512
const FONT_START = 0
const FONT_SIZE = 5

const memoryMap = new Uint8Array(RAM_SIZE)
loadFont()

function loadFont(): void {
  memoryMap.set([0xf0, 0x90, 0x90, 0x90, 0xf0], 0) // "0"
  memoryMap.set([0x20, 0x60, 0x20, 0x20, 0x70], 5) // "1"
  memoryMap.set([0xf0, 0x10, 0xf0, 0x80, 0xf0], 10) // "2"
  memoryMap.set([0xf0, 0x10, 0xf0, 0x10, 0xf0], 15) // "3"
  memoryMap.set([0x90, 0x90, 0xf0, 0x10, 0x10], 20) // "4"
  memoryMap.set([0xf0, 0x80, 0xf0, 0x10, 0xf0], 25) // "5"
  memoryMap.set([0xf0, 0x80, 0xf0, 0x90, 0xf0], 30) // "6"
  memoryMap.set([0xf0, 0x10, 0x20, 0x40, 0x40], 35) // "7"
  memoryMap.set([0xf0, 0x90, 0xf0, 0x90, 0xf0], 40) // "8"
  memoryMap.set([0xf0, 0x90, 0xf0, 0x10, 0xf0], 45) // "9"
  memoryMap.set([0xf0, 0x90, 0xf0, 0x90, 0x90], 50) // "A"
  memoryMap.set([0xe0, 0x90, 0xe0, 0x90, 0xe0], 55) // "B"
  memoryMap.set([0xf0, 0x80, 0x80, 0x80, 0xf0], 60) // "C"
  memoryMap.set([0xe0, 0x90, 0x90, 0x90, 0xe0], 65) // "D"
  memoryMap.set([0xf0, 0x80, 0xf0, 0x80, 0xf0], 70) // "E"
  memoryMap.set([0xf0, 0x80, 0xf0, 0x80, 0x80], 75) // "F"
}

function loadRom(buffer: ArrayBuffer): void {
  clearRom()
  const rom = new Uint8Array(buffer)
  memoryMap.set(rom, ROM_START)
}

function clearRom(): void {
  memoryMap.fill(0x00, ROM_START)
}

export {
  memoryMap as default,
  loadRom,
  clearRom,
  ROM_START,
  FONT_START,
  FONT_SIZE,
}
